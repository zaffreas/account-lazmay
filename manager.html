<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Manager Dashboard</title>

  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
  <link rel="stylesheet" href="manager.css">
</head>

<body>
<div class="app">

  <!-- Top Bar -->
  <header class="top-bar">
    <span class="material-symbols-outlined">menu</span>
    <h1>Manager Dashboard</h1>
    <span class="material-symbols-outlined">notifications</span>
  </header>

  <!-- Date Strip -->
  <section class="date-strip">
    <div id="date-strip"></div>
  </section>

  <!-- Tabs -->
  <section class="tabs">
    <button class="tab active">Expenditure</button>
    <button class="tab">Sales</button>
  </section>

  <!-- Content -->
  <main id="expenditure-content" class="content">

    <h2>Vehicle Expenses</h2>

    <!-- Six collapsible vehicle sections -->
    <details open>
      <summary>
        <span class="material-symbols-outlined">v</span>
        Vehicle 1
      </summary>
      <div class="form-grid">
        <div>
          <label>Fuel</label>
          <input type="number" placeholder="0.00" class="veh-fuel">
        </div>
        <div>
          <label>Oil</label>
          <input type="number" placeholder="0.00" class="veh-oil">
        </div>
        <div>
          <label>Repairs</label>
          <input type="number" placeholder="0.00" class="veh-repairs">
        </div>
      </div>
    </details>

    <details>
      <summary>
        <span class="material-symbols-outlined">v</span>
        Vehicle 2
      </summary>
      <div class="form-grid">
        <div>
          <label>Fuel</label>
          <input type="number" placeholder="0.00" class="veh-fuel">
        </div>
        <div>
          <label>Oil</label>
          <input type="number" placeholder="0.00" class="veh-oil">
        </div>
        <div>
          <label>Repairs</label>
          <input type="number" placeholder="0.00" class="veh-repairs">
        </div>
      </div>
    </details>

    <details>
      <summary>
        <span class="material-symbols-outlined">v</span>
        Vehicle 3
      </summary>
      <div class="form-grid">
        <div>
          <label>Fuel</label>
          <input type="number" placeholder="0.00" class="veh-fuel">
        </div>
        <div>
          <label>Oil</label>
          <input type="number" placeholder="0.00" class="veh-oil">
        </div>
        <div>
          <label>Repairs</label>
          <input type="number" placeholder="0.00" class="veh-repairs">
        </div>
      </div>
    </details>

    <details>
      <summary>
        <span class="material-symbols-outlined">v</span>
        Vehicle 4
      </summary>
      <div class="form-grid">
        <div>
          <label>Fuel</label>
          <input type="number" placeholder="0.00" class="veh-fuel">
        </div>
        <div>
          <label>Oil</label>
          <input type="number" placeholder="0.00" class="veh-oil">
        </div>
        <div>
          <label>Repairs</label>
          <input type="number" placeholder="0.00" class="veh-repairs">
        </div>
      </div>
    </details>

    <details>
      <summary>
        <span class="material-symbols-outlined">v</span>
        Vehicle 5
      </summary>
      <div class="form-grid">
        <div>
          <label>Fuel</label>
          <input type="number" placeholder="0.00" class="veh-fuel">
        </div>
        <div>
          <label>Oil</label>
          <input type="number" placeholder="0.00" class="veh-oil">
        </div>
        <div>
          <label>Repairs</label>
          <input type="number" placeholder="0.00" class="veh-repairs">
        </div>
      </div>
    </details>

    <details>
      <summary>
        <span class="material-symbols-outlined">v</span>
        Vehicle 6
      </summary>
      <div class="form-grid">
        <div>
          <label>Fuel</label>
          <input type="number" placeholder="0.00" class="veh-fuel">
        </div>
        <div>
          <label>Oil</label>
          <input type="number" placeholder="0.00" class="veh-oil">
        </div>
        <div>
          <label>Repairs</label>
          <input type="number" placeholder="0.00" class="veh-repairs">
        </div>
      </div>
    </details>

    <h2>Operational Expenses</h2>

    <div class="row">
      <span>Generator Fuel</span>
      <input type="number" placeholder="0.00" id="generator-fuel">
    </div>

    <div class="row">
      <span>Salary</span>
      <input type="number" placeholder="0.00" id="salary">
    </div>

    <h2>Miscellaneous</h2>

    <textarea id="misc-desc" placeholder="Describe other expenses..."></textarea>
    <input type="number" placeholder="Amount" id="misc-amount">

  </main>

    <!-- Sales Content (hidden by default) -->
    <main id="sales-content" class="content" style="display:none">
      <h2>Vehicle Sales</h2>

      <!-- Six collapsible vehicle sales sections -->
      <details open>
        <summary>
          <span class="material-symbols-outlined">v</span>
          Vehicle 1
        </summary>
        <div class="form-grid">
          <div>
            <label>No. of Bags</label>
            <input type="number" placeholder="0" class="sales-bags">
          </div>
          <div>
            <label>Total Amount</label>
            <input type="number" placeholder="0.00" class="sales-amount">
          </div>
        </div>
      </details>

      <details>
        <summary>
          <span class="material-symbols-outlined">v</span>
          Vehicle 2
        </summary>
        <div class="form-grid">
          <div>
            <label>No. of Bags</label>
            <input type="number" placeholder="0" class="sales-bags">
          </div>
          <div>
            <label>Total Amount</label>
            <input type="number" placeholder="0.00" class="sales-amount">
          </div>
        </div>
      </details>

      <details>
        <summary>
          <span class="material-symbols-outlined">v</span>
          Vehicle 3
        </summary>
        <div class="form-grid">
          <div>
            <label>No. of Bags</label>
            <input type="number" placeholder="0" class="sales-bags">
          </div>
          <div>
            <label>Total Amount</label>
            <input type="number" placeholder="0.00" class="sales-amount">
          </div>
        </div>
      </details>

      <details>
        <summary>
          <span class="material-symbols-outlined">v</span>
          Vehicle 4
        </summary>
        <div class="form-grid">
          <div>
            <label>No. of Bags</label>
            <input type="number" placeholder="0" class="sales-bags">
          </div>
          <div>
            <label>Total Amount</label>
            <input type="number" placeholder="0.00" class="sales-amount">
          </div>
        </div>
      </details>

      <details>
        <summary>
          <span class="material-symbols-outlined">v</span>
          Vehicle 5
        </summary>
        <div class="form-grid">
          <div>
            <label>No. of Bags</label>
            <input type="number" placeholder="0" class="sales-bags">
          </div>
          <div>
            <label>Total Amount</label>
            <input type="number" placeholder="0.00" class="sales-amount">
          </div>
        </div>
      </details>

      <details>
        <summary>
          <span class="material-symbols-outlined">v</span>
          Vehicle 6
        </summary>
        <div class="form-grid">
          <div>
            <label>No. of Bags</label>
            <input type="number" placeholder="0" class="sales-bags">
          </div>
          <div>
            <label>Total Amount</label>
            <input type="number" placeholder="0.00" class="sales-amount">
          </div>
        </div>
      </details>

      <h2>Other Sales</h2>

      <!-- Distributors 1..3 -->
      <details>
        <summary>
          <span class="material-symbols-outlined">v</span>
          Distributor 1
        </summary>
        <div class="form-grid">
          <div>
            <label>No. of Bags</label>
            <input type="number" placeholder="0" class="dist-bags">
          </div>
          <div>
            <label>Rate</label>
            <input type="number" placeholder="0.00" class="dist-rate">
          </div>
        </div>
      </details>

      <details>
        <summary>
          <span class="material-symbols-outlined">v</span>
          Distributor 2
        </summary>
        <div class="form-grid">
          <div>
            <label>No. of Bags</label>
            <input type="number" placeholder="0" class="dist-bags">
          </div>
          <div>
            <label>Rate</label>
            <input type="number" placeholder="0.00" class="dist-rate">
          </div>
        </div>
      </details>

      <details>
        <summary>
          <span class="material-symbols-outlined">v</span>
          Distributor 3
        </summary>
        <div class="form-grid">
          <div>
            <label>No. of Bags</label>
            <input type="number" placeholder="0" class="dist-bags">
          </div>
          <div>
            <label>Rate</label>
            <input type="number" placeholder="0.00" class="dist-rate">
          </div>
        </div>
      </details>

      <h2>Individuals</h2>
      <details>
        <summary>
          <span class="material-symbols-outlined">v</span>
          Individuals
        </summary>
        <div class="form-grid">
          <div>
            <label>No. of Bags</label>
            <input type="number" placeholder="0" class="ind-bags">
          </div>
          <div>
            <label>Amount</label>
            <input type="number" placeholder="0.00" class="ind-amount">
          </div>
        </div>
      </details>

    </main>

    <!-- Footer -->
  <footer class="footer">
    <div>
      <small id="total-label">Total Expenditure</small>
      <strong id="total-amount">₦0.00</strong>
    </div>
    <div>
      <small>Balance</small>
      <strong id="balance-amount">₦0.00</strong>
    </div>
    <button class="save">Save Record</button>
  </footer>

</div>
<script>
(function(){
  const container = document.getElementById('date-strip');
  if(!container) return;
  const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  const days = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
  for(let i=0;i<10;i++){
    const d = new Date();
    d.setDate(d.getDate()-i);
    const btn = document.createElement('button');
    btn.className = 'date' + (i===0 ? ' active' : '');
    btn.dataset.date = d.toISOString().slice(0,10);
    const small = document.createElement('small');
    small.textContent = i===0 ? 'Today' : days[d.getDay()];
    const strong = document.createElement('strong');
    strong.textContent = d.getDate();
    const span = document.createElement('span');
    span.textContent = months[d.getMonth()];
    btn.appendChild(small);
    btn.appendChild(strong);
    btn.appendChild(span);
    container.appendChild(btn);
  }
})();
</script>
<script>
(function(){
  function parseVal(el){ if(!el) return 0; const v = parseFloat(el.value); return isNaN(v)?0:v; }
  function sum(selector){ return Array.from(document.querySelectorAll(selector)).reduce((s,el)=> s + parseVal(el), 0); }

  function updateTotal(){
    const salesVisible = document.getElementById('sales-content') && getComputedStyle(document.getElementById('sales-content')).display !== 'none';
    const out = document.getElementById('total-amount');
    const label = document.getElementById('total-label');
    const balEl = document.getElementById('balance-amount');
    if(!out) return;

    // Expenditure total
    const fuels = sum('.veh-fuel');
    const oils = sum('.veh-oil');
    const repairs = sum('.veh-repairs');
    const gen = parseVal(document.getElementById('generator-fuel'));
    const sal = parseVal(document.getElementById('salary'));
    const misc = parseVal(document.getElementById('misc-amount'));
    const expenditureTotal = fuels + oils + repairs + gen + sal + misc;

    // Sales total
    const vehicleSales = sum('.sales-amount');
    const distBags = Array.from(document.querySelectorAll('.dist-bags'));
    const distRates = Array.from(document.querySelectorAll('.dist-rate'));
    let distTotal = 0;
    for(let i=0;i<Math.max(distBags.length, distRates.length); i++){
      const b = parseVal(distBags[i]);
      const r = parseVal(distRates[i]);
      distTotal += b * r;
    }
    const indTotal = sum('.ind-amount');
    const salesTotal = vehicleSales + distTotal + indTotal;

    // show correct main total depending on view
    if(label) label.textContent = salesVisible ? 'Total Sales' : 'Total Expenditure';
    out.textContent = '₦' + (salesVisible ? salesTotal : expenditureTotal).toFixed(2);

    // balance = sales - expenditure (visible always)
    if(balEl) balEl.textContent = '₦' + (salesTotal - expenditureTotal).toFixed(2);
  }

  // wire inputs
  const expInputs = Array.from(document.querySelectorAll('.veh-fuel, .veh-oil, .veh-repairs, #generator-fuel, #salary, #misc-amount'));
  const salesInputs = Array.from(document.querySelectorAll('.sales-amount, .sales-bags, .dist-bags, .dist-rate, .ind-amount'));
  expInputs.concat(salesInputs).forEach(i=> i && i.addEventListener('input', updateTotal));

  // tab switching
  const tabs = document.querySelectorAll('.tabs .tab');
  const expEl = document.getElementById('expenditure-content');
  const salesEl = document.getElementById('sales-content');
  function showTab(name){
    if(name === 'sales'){
      if(expEl) expEl.style.display = 'none';
      if(salesEl) salesEl.style.display = 'block';
      tabs.forEach(t=> t.classList.toggle('active', t.textContent.trim().toLowerCase() === 'sales'));
    } else {
      if(expEl) expEl.style.display = 'block';
      if(salesEl) salesEl.style.display = 'none';
      tabs.forEach(t=> t.classList.toggle('active', t.textContent.trim().toLowerCase() === 'expenditure'));
    }
    updateTotal();
  }
  tabs.forEach(t=> t.addEventListener('click', ()=> showTab(t.textContent.trim().toLowerCase())));
  // initialize view from active tab
  const activeTab = document.querySelector('.tabs .tab.active');
  showTab(activeTab ? activeTab.textContent.trim().toLowerCase() : 'expenditure');
  updateTotal();

  // --- Date selection and save/load per date ---
  const dateButtons = Array.from(document.querySelectorAll('.date-strip .date'));
  function setActiveDate(btn){ dateButtons.forEach(b=> b.classList.toggle('active', b===btn)); }
  function getActiveDate(){ const a = dateButtons.find(b=> b.classList.contains('active')); return a ? a.dataset.date : (new Date()).toISOString().slice(0,10); }

  function clearInputs(){
    Array.from(document.querySelectorAll('.veh-fuel, .veh-oil, .veh-repairs, #generator-fuel, #salary, #misc-amount, .sales-amount, .sales-bags, .dist-bags, .dist-rate, .ind-amount, .ind-bags')).forEach(el=> el && (el.value=''));
    const ta = document.getElementById('misc-desc'); if(ta) ta.value = '';
  }

  function loadData(date){
    if(!date) return;
    const key = 'records:' + date;
    const raw = localStorage.getItem(key);
    if(!raw){ clearInputs(); updateTotal(); return; }
    try{
      const data = JSON.parse(raw);
      Array.from(document.querySelectorAll('.veh-fuel')).forEach((el,i)=> el.value = (data.expenditure && data.expenditure.vehFuel && data.expenditure.vehFuel[i]) || '');
      Array.from(document.querySelectorAll('.veh-oil')).forEach((el,i)=> el.value = (data.expenditure && data.expenditure.vehOil && data.expenditure.vehOil[i]) || '');
      Array.from(document.querySelectorAll('.veh-repairs')).forEach((el,i)=> el.value = (data.expenditure && data.expenditure.vehRepairs && data.expenditure.vehRepairs[i]) || '');
      const gen = document.getElementById('generator-fuel'); if(gen) gen.value = (data.expenditure && data.expenditure.generatorFuel) || '';
      const sal = document.getElementById('salary'); if(sal) sal.value = (data.expenditure && data.expenditure.salary) || '';
      const misc = document.getElementById('misc-amount'); if(misc) misc.value = (data.expenditure && data.expenditure.miscAmount) || '';
      const ta = document.getElementById('misc-desc'); if(ta) ta.value = (data.expenditure && data.expenditure.miscDesc) || '';

      Array.from(document.querySelectorAll('.sales-bags')).forEach((el,i)=> el.value = (data.sales && data.sales.salesBags && data.sales.salesBags[i]) || '');
      Array.from(document.querySelectorAll('.sales-amount')).forEach((el,i)=> el.value = (data.sales && data.sales.salesAmount && data.sales.salesAmount[i]) || '');
      Array.from(document.querySelectorAll('.dist-bags')).forEach((el,i)=> el.value = (data.sales && data.sales.distBags && data.sales.distBags[i]) || '');
      Array.from(document.querySelectorAll('.dist-rate')).forEach((el,i)=> el.value = (data.sales && data.sales.distRate && data.sales.distRate[i]) || '');
      Array.from(document.querySelectorAll('.ind-bags')).forEach((el,i)=> el.value = (data.sales && data.sales.indBags && data.sales.indBags[i]) || '');
      Array.from(document.querySelectorAll('.ind-amount')).forEach((el,i)=> el.value = (data.sales && data.sales.indAmount && data.sales.indAmount[i]) || '');

    }catch(e){ console.error('Failed to parse saved data for', date, e); clearInputs(); }
    updateTotal();
  }

  function saveData(date){
    if(!date) return;
    const data = { expenditure: {}, sales: {} };
    data.expenditure.vehFuel = Array.from(document.querySelectorAll('.veh-fuel')).map(el=> el.value || '');
    data.expenditure.vehOil = Array.from(document.querySelectorAll('.veh-oil')).map(el=> el.value || '');
    data.expenditure.vehRepairs = Array.from(document.querySelectorAll('.veh-repairs')).map(el=> el.value || '');
    data.expenditure.generatorFuel = (document.getElementById('generator-fuel')||{value:''}).value || '';
    data.expenditure.salary = (document.getElementById('salary')||{value:''}).value || '';
    data.expenditure.miscAmount = (document.getElementById('misc-amount')||{value:''}).value || '';
    data.expenditure.miscDesc = (document.getElementById('misc-desc')||{value:''}).value || '';

    data.sales.salesBags = Array.from(document.querySelectorAll('.sales-bags')).map(el=> el.value || '');
    data.sales.salesAmount = Array.from(document.querySelectorAll('.sales-amount')).map(el=> el.value || '');
    data.sales.distBags = Array.from(document.querySelectorAll('.dist-bags')).map(el=> el.value || '');
    data.sales.distRate = Array.from(document.querySelectorAll('.dist-rate')).map(el=> el.value || '');
    data.sales.indBags = Array.from(document.querySelectorAll('.ind-bags')).map(el=> el.value || '');
    data.sales.indAmount = Array.from(document.querySelectorAll('.ind-amount')).map(el=> el.value || '');

    try{ localStorage.setItem('records:' + date, JSON.stringify(data)); alert('Saved data for ' + date); }
    catch(e){ console.error('Save failed', e); alert('Failed to save'); }
  }

  // wire date buttons
  dateButtons.forEach(btn=> btn.addEventListener('click', ()=>{ setActiveDate(btn); loadData(btn.dataset.date); }));

  // initialize load for active date (or first)
  const activeDateBtn = dateButtons.find(b=> b.classList.contains('active')) || dateButtons[0];
  if(activeDateBtn){ setActiveDate(activeDateBtn); loadData(activeDateBtn.dataset.date); }

  // save button
  const saveBtn = document.querySelector('button.save');
  if(saveBtn) saveBtn.addEventListener('click', ()=>{ const date = getActiveDate(); if(date) saveData(date); });
})();
</script>
</body>
</html>
